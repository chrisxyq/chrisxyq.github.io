---
layout: post
title: 常用类
catalog: true
tags:
    - Java
---
# 1.常用类

## 1.1 Object类

![image-20210110214745887](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210110214745887.png)

### 1.1.1 equals()

![image-20210110214803059](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210110214803059.png)

### 1.1.2 toString()

![image-20210110215202136](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210110215202136.png)

## 1.2包装类

![image-20210110215222781](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210110215222781.png)

如equals()只能用于引用数据类型，因此int这种基本数据类型通过包装类才能用equals()方法

### 1.2.1基本数据类型与包装类的转换

![image-20210110215237807](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210110215237807.png)

当一些方法的形参是类类型的，需要将基本数据类型转成包装类

JDK5.0自动装箱

![image-20210110215253167](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210110215253167.png)

![image-20210110215309901](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210110215309901.png)

当包装类需要进行四则运算时候，需要转成基本数据类型

![image-20210110215329060](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210110215329060.png)

![image-20210110215344791](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210110215344791.png)

### 1.2.2基本数据类型与string的转换

![image-20210110215402274](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210110215402274.png)

必须是子父类之间关系的才能强转(),string不能强转成int

测试：![image-20210110215422039](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210110215422039.png)

## 1.3String类

### 1.3.1理解string的不可变性

![1590763872817](https://gitee.com/chrisxyq/picgo/raw/master/img/1590763872817.png)

#### 1.3.1.1字面量方式实例化的内存解析

![image-20210123155221325](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123155221325.png)

string类有一个final类型的属性为一个string[]数组，string类的值即存储在此数组中，第三行代码运行时，将在常量池新建hello，并改变s1指针的位置，将其指向hello。（字符串拼接以及replace字符串的数组，也是如此，而不是在原有字符串位置后面新增/修改）

即一个变量的修改，不会影响其他string变量

### 1.3.2string两种实例化方式的区别：字面量/new+构造器

#### 1.3.2.1通过字面量定义的，其数据都在常量池中，记录的是常量池的地址值

举例如下

![image-20210123165400399](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123165400399.png)

#### 1.3.2.2new+构造器实例化的string：记录的是堆的地址值

两个例子如下

![image-20210123165020792](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123165020792.png)

![image-20210123170139139](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123170139139.png)

注：string的equals是比较值，==则是比较地址值

#### 1.3.2.3java值传递&string不可变性的举例

![1590834888305](https://gitee.com/chrisxyq/picgo/raw/master/img/1590834888305.png)

### 1.3.3String常用方法

![1590836172775](https://gitee.com/chrisxyq/picgo/raw/master/img/1590836172775.png)

![image-20210123174814218](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123174814218.png)

![image-20210123175249602](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123175249602.png)

- tolowercase不会改变原string、该方法需要返回值接收

- contains/indexof判断一个字符串是否包含某字符序列

  ![image-20210123174658848](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123174658848.png)

1.3.4string与基本数据类型包装类之间的转换

![1590836130610](https://gitee.com/chrisxyq/picgo/raw/master/img/1590836130610.png)

![1590836319545](https://gitee.com/chrisxyq/picgo/raw/master/img/1590836319545.png)



## 1.4StringBuffer、StringBuilder

### 1.4.1StringBuffer常用方法

![1590839374366](https://gitee.com/chrisxyq/picgo/raw/master/img/1590839374366.png)

![1590839454122](https://gitee.com/chrisxyq/picgo/raw/master/img/1590839454122.png)

注：

- string拼接用+或者concat、stringbuffer拼接用append



### 1.4.2StringBuffer、StringBuilder异同

注：

- idea：ctrl+shift+T全局搜索类、可看源码

- jdk5.0的stringbuilder类的方法没有synchronized修饰，因此是线程不安全的
- stringbuffer和stringbuilder的类中，用于存储的char[]数组没有被final修饰，因此是可变的
- 以setcharat方法举例，由于string是不可变的，因此需要返回值来接收。而stringbuffer可变，直接原地修改，没有返回值

### 1.4.3StringBuffer、StringBuilder底层char[]数组的初始化和扩容

为支持原地动态扩容，stringbuffer的无参和带参构造器所构造的char[]数组均有16的富余

![image-20210123204541318](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123204541318.png)

![image-20210123204817503](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123204817503.png)

![1590839151834](https://gitee.com/chrisxyq/picgo/raw/master/img/1590839151834.png)

扩容源码：

![image-20210123211057748](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123211057748.png)

![1590839184521](https://gitee.com/chrisxyq/picgo/raw/master/img/1590839184521.png)

备注：

![image-20210123233619181](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123233619181.png)

![image-20210123233849295](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123233849295.png)

![image-20210123204817503](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123204817503.png)

由于调用null.length，因此将抛出空指针异常

## 1.5string算法举例

### 1.5.1局部反转string

![image-20210123215849421](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123215849421.png)

![image-20210123220150439](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123220150439.png)

![image-20210123220822542](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123220822542.png)

### 1.5.2获取字符串出现的次数

![image-20210123225936153](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123225936153.png)

![image-20210123225909380](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123225909380.png)

### 1.5.3最大相同子串

![image-20210123231537332](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123231537332.png)

![image-20210123232154262](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210123232154262.png)

## 1.6对象实现排序

如商家按照距离、评分等排序

### 1.6.1comparable接口：适用于自定义类的排序：实现comparable接口、重写compareto方法

![image-20210124000613623](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210124000613623.png)

![image-20210124000909353](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210124000909353.png)

测试：调用对象数组的sort方法即可，按照对象类中自己重写的compareto规则进行排序

![image-20210124001023584](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210124001023584.png)

### 1.6.2comparator接口:适用于已有类的排序，不方便实现comparable接口的情况

![image-20210124020522691](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210124020522691.png)



## 1.7集合-collection接口

### 1.7.1数组的缺点

![1590910691407](https://gitee.com/chrisxyq/picgo/raw/master/img/1590910691407.png)

### 1.7.2collection接口的常用方法

- add：可添加string、int、date、布尔等元素
- size：集合内元素的个数
- addall：把另一个集合的元素都添过来
- isempty：判断集合是否为空/size是否为0
- clear：清空集合内的元素
- contains：判断集合是否包含某元素、是通过调用该元素的类的equals方法进行比较判断的（object的equals方法默认比较的是引用）而非内容（==）、若对象重写了equals方法，则只要内容一样，即contains为true（如string
- remove（对象）：从集合中删除某对象、若删除成功、则返回true
- 集合1.retainall（集合2）：求集合的交集、直接修改集合1
- 集合1.removeall（集合2）：求集合的差集、直接修改集合1
- 集合1.equals（集合2）：按顺序调用集合元素的equals方法、（集合是有序的
- 集合.toarray()：集合转数组
- arrays.aslist(数组/多个元素)：数组转集合

### 1.7.3集合遍历

- iterator()：返回一个迭代器iterator接口的对象

  ![image-20210124160506379](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210124160506379.png)

  迭代器提供的remove方法

  ![image-20210124160811569](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210124160811569.png)

- foreach：内部调用迭代器

  ![image-20210124161410364](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210124161410364.png)

注意：普通for循环和增强for循环的区别（增强for循环是重新赋了值给新的变量s、参考string字符串的内存

![image-20210124161636784](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210124161636784.png)

### 1.7.4collection接口的子接口-list：元素有序可重复、动态数组

![1590921368429](https://gitee.com/chrisxyq/picgo/raw/master/img/1590921368429.png)

![image-20210124185654471](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210124185654471.png)

#### 1.7.4.1arraylist

- jdk7：arraylist默认空参构造器创建长度为10的object[]数组（stringbuffer的空参构造器创建了长度为16的char[]数组
- jdk8：为节省内存、arraylist默认空参构造器不创建数组、当我们第一次add元素时，才创建长度为10的object[]数组

- arraylist默认扩容1.5倍，并将原有数据复制到新数组（stringbuffer默认扩容为两倍加2

![image-20210124163950905](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210124163950905.png)

- 为避免扩容/数组的数据复制，实际开发中，若大概知道数组长度，可使用带参构造器创建arraylist

#### 1.7.4.2linkedlist

linkedlist查找不方便、元素需要维护指针

arraylist增加删除不方便

linkedlist源码有node这个静态内部类、还有首尾node类型的属性、静态内部类如下：

![1590922846514](https://gitee.com/chrisxyq/picgo/raw/master/img/1590922846514.png)

linkedlist添加一个元素源码：更新lastnode属性

![image-20210124165857503](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210124165857503.png)



#### 1.7.4.3线程安全的arraylist

collections工具类有个方法叫synchronizedlist，把arraylist对象作为参数放进该方法中，将返回线程安全的arraylist



### 1.7.3collection接口的子接口-set：元素无序不可重复

#### 1.7.3.1hashset

遍历时候的顺序为：元素的哈希值的顺序、而非添加时候的顺序

线程不安全，可以存储null值

![1596289716491](https://gitee.com/chrisxyq/picgo/raw/master/img/1596289716491.png)

#### 1.7.3.2linkedhashset

是HashSet的子类，遍历时，可以按照添加的顺序遍历

#### 1.7.3.3treeset

放入的对象需要是同一个类new出来的对象，并根据对象的某些属性排序

![1596290257245](https://gitee.com/chrisxyq/picgo/raw/master/img/1596290257245.png)

自然排序与定制排序

![1596290553807](https://gitee.com/chrisxyq/picgo/raw/master/img/1596290553807.png)

自然排序：则根据放入对象的compareTo方法来排序，即放入对象user需要实现compareTo接口

![1596290881862](https://gitee.com/chrisxyq/picgo/raw/master/img/1596290881862.png)

定制排序示例

![1596290664116](https://gitee.com/chrisxyq/picgo/raw/master/img/1596290664116.png)

## 1.8集合-map接口

![1596292885015](https://gitee.com/chrisxyq/picgo/raw/master/img/1596292885015.png)

### 1.8.1hashmap

- hashmap的键值对允许为null，保证了程序的健壮性，如用户登录时，未填写用户名和密码，此时程序未报空指针异常

#### 1.8.1.1HashMap和CurrentHashMap的区别？

- HashMap是线程不安全的
- CurrentHashMap是为了解决多线程并发是单线程操作共享数据效率低下的问题。将共享数据分段，实现多个线程共同操作共享数据。如XX用户买XX-XX车厢，xx用户买XX-XX车厢。

#### 1.8.1.2map结构的理解：

一个键值对称为一个entry

![1596293668372](https://gitee.com/chrisxyq/picgo/raw/master/img/1596293668372.png)

#### 1.8.1.3map.put()的底层实现原理

jdk7

![1596294871667](https://gitee.com/chrisxyq/picgo/raw/master/img/1596294871667.png)

情况3，且无需扩容时，将新的entry插入数组的hashcode位置处，将原来位置处的entry作为新的entry的next指针指向（存放于链表处

jdk8

![1596295166788](https://gitee.com/chrisxyq/picgo/raw/master/img/1596295166788.png)

![1596295216958](https://gitee.com/chrisxyq/picgo/raw/master/img/1596295216958.png)

#### 1.8.1.4hashmap源码分析

jdk7

- initialcapacity：为用户指定的初始容量，若用户指定initialcapacity为15，则hashmap实际将构造长度为16的hashmap，源码如下

![image-20210124200948759](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210124200948759.png)

- loadfactor：负载因子，默认为0.75

- threshold：临界值，默认为16*0.75=12、当超出临界值，且要存放的位置非空时，扩容

- hashmap底层为数组，数组为entry[]类型、名为table

  ![image-20210124201248860](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210124201248860.png)

#### 1.8.1.5遍历hashmap

keyset、values、entryset

![image-20210124204940429](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210124204940429.png)

![image-20210124205146397](https://gitee.com/chrisxyq/picgo/raw/master/img/image-20210124205146397.png)



### 1.8.2linkedhashmap



### 1.8.3treemap



### 1.8.4hashtable













